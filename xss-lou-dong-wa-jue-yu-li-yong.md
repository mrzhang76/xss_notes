# XSS漏洞挖掘与利用

大多数XSS漏洞来自没有进行严格过滤的后端输出函数，这些函数是XSS攻击达成的关键。

 “PHP是全世界最好的语言”，许多网站使用PHP编写，对PHP的后端输出函数要多加注意。

##  一、XSS漏洞的挖掘 

要挖掘XSS漏洞，我们需要知道什么样的网站存在XSS漏洞，XSS漏洞通常出现在网站哪些地方以及掌握挖掘XSS漏洞的方法。 

### 什么样的网站可能存在XSS漏洞？ 

如果一个网站，用户可以对其进行内容输入，这些内容经过或未经过处理输出在网站某个页面上，这个网站就具备了存在XSS漏洞的基本条件，也就是：

1. 网站中某个页面存在可以进行输入的地方。 
2. 网站中某个页面存在可以输出用户输入内容的地方。

存在这种用户交互逻辑的网站，我们就可以尝试对其进行XSS漏洞的挖掘。 如果一个网站存在敏感组件，例如FLASH，那也有可能存在XSS漏洞。

### XSS漏洞通常出现在哪些地点？ 

通常情况下，只有满足XSS漏洞产生基本条件的网站页面才有可能存在XSS漏洞。 根据这一原理，我们可以推断出XSS漏洞的常见出现地点。 

1、存在数据交互 

* GET、POST、COOKIES、HEADERS 
* 反馈与浏览 
* 富文本编辑器 
* 各类标签插入和自定义 

2、存在内容输入与输出 

* 用户资料，签名等 
* 关键词、标签、说明 
* 文件上传

3、存在敏感组件：FLASH 

进行XSS漏洞挖掘时要结合各种类型漏洞的特点进行挖掘。

### 挖掘XSS漏洞的方法 

挖掘XSS漏洞有手动挖掘与工具挖掘两种方式 

* 手动挖掘效率低，精确度高，不易触发反入侵监测； 
* 工具挖掘效率高，高线程易触发反入侵监测；

 通常情况下都是使用工具扫描后再手动详细挖掘，已获得更高精确度。 

### 挖掘XSS漏洞的简单流程 \(JSXSS\)

#### 一、挖掘XSS漏洞的简单流程：手动挖掘 

进行挖掘前需关闭浏览器的XSS过滤器 

**1、确认网站是否有存在XSS漏洞的条件，定位可能存在XSS漏洞的高危页面** 

如果一个网站满足存在XSS漏洞的基本条件，我们就可以尝试对可能存在的XSS漏洞进行手动挖掘，并根据XSS漏洞的常见地点来定位可能存在漏洞的高危页面。当收集到网站中的高危页面后，就可以进行漏洞挖掘了。 

**2、对高危页面进行输入输出等测试** 

XSS漏洞通常情况下要网站存在输入和输出。在可以进行用户输入的页面输入并不敏感的字符串,并在此页面或网站的其他页面（概率较低）中寻找刚才输入的字符串是否输出到任一页面中。

如存在输出就将不敏感字符串替换为简单攻击代码，如：alert\('xss'\)；并检查攻击代码是否生效。 当使用简单攻击代码对页面进行攻击后成功弹出提示框（alert\('xss'\);//JS代码，弹出提示框并显示xss）即为攻击成功，此时可以确定高危页面的此处存在XSS漏洞。 

如果没有成功弹出提示框，需要检测此处存在的过滤类型。 

如果是存在敏感组件FLASH的高危页面，需要对FLASH行为进行分析，详见 

**3、简单攻击代码生效：确认XSS漏洞存在形式** 

如果弹窗在输出页面刷新后没有再次出现，此漏洞有可能为反射型XSS 

如果弹窗在输出页面刷新多次后依然出现，此漏洞有可能为存储型XSS 

此时可以根据漏洞的不同形式选择利用方式 

**4、简单攻击代码无效：确认过滤形式** 

依次测试敏感字符的输出情况，推测出可能的过滤方式与突破方法 

**5、手动挖掘XSS漏洞过程中可能需要工具**

* 开发者工具（现代浏览器自带）
* BURPSITE 
* HACKBAR插件（浏览器插件）

![&#x624B;&#x52A8;&#x6316;&#x6398;JSXSS&#x7684;&#x7B80;&#x5355;&#x6D41;&#x7A0B;](.gitbook/assets/image%20%2842%29.png)

